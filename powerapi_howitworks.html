<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PowerAPI - How it works ? | PowerAPI</title>
    <meta name="description" content="PowerAPI documentation.">
    
    
    <link rel="preload" href="/powerapi-doc/assets/css/0.styles.3cdd15d1.css" as="style"><link rel="preload" href="/powerapi-doc/assets/js/app.d5220592.js" as="script"><link rel="preload" href="/powerapi-doc/assets/js/2.68cf461d.js" as="script"><link rel="preload" href="/powerapi-doc/assets/js/8.ee533614.js" as="script"><link rel="prefetch" href="/powerapi-doc/assets/js/10.3fa139c5.js"><link rel="prefetch" href="/powerapi-doc/assets/js/3.4e51276d.js"><link rel="prefetch" href="/powerapi-doc/assets/js/4.4cf084c7.js"><link rel="prefetch" href="/powerapi-doc/assets/js/5.c9d28340.js"><link rel="prefetch" href="/powerapi-doc/assets/js/6.a7fbfe5c.js"><link rel="prefetch" href="/powerapi-doc/assets/js/7.f5cbdc2a.js"><link rel="prefetch" href="/powerapi-doc/assets/js/9.418d8020.js">
    <link rel="stylesheet" href="/powerapi-doc/assets/css/0.styles.3cdd15d1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/powerapi-doc/" class="home-link router-link-active"><!----> <span class="site-name">PowerAPI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/powerapi-ng/powerapi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/powerapi-ng/powerapi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PowerAPI</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powerapi-doc/powerapi_howitworks.html" class="active sidebar-link">PowerAPI - How it works ?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/powerapi-doc/powerapi_howitworks.html#power-meter-architecture" class="sidebar-link">Power meter Architecture</a></li><li class="sidebar-sub-header"><a href="/powerapi-doc/powerapi_howitworks.html#sensor" class="sidebar-link">Sensor</a></li><li class="sidebar-sub-header"><a href="/powerapi-doc/powerapi_howitworks.html#formula" class="sidebar-link">Formula</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Sensor</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powerapi-doc/hwpc.html" class="sidebar-link">HWPC Sensor</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Formula</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powerapi-doc/rapl.html" class="sidebar-link">RAPL Formula</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Howto</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/powerapi-doc/howto_monitor_socket.html" class="sidebar-link">How to monitor power consumption of a socket</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="powerapi-how-it-works"><a href="#powerapi-how-it-works" aria-hidden="true" class="header-anchor">#</a> PowerAPI - How it works ?</h1> <h2 id="power-meter-architecture"><a href="#power-meter-architecture" aria-hidden="true" class="header-anchor">#</a> Power meter Architecture</h2> <p>A power meter is a set of two components, a sensor and a formula, used to
produce an estimation of the power consumption of a monitored software.</p> <p>The sensor collects raw data correlated with the power consumption of the
software. The formula is a model that use the collected data to compute the
power consumption. Both of them are connected by a database that is used to
transfer data from the sensor to the formula.</p> <p>The two next sub-sections present how a sensor and a formula
work and how they should be used.</p> <p><img src="powerAPI_archi.png" alt="Architecture of PowerAPI"></p> <h2 id="sensor"><a href="#sensor" aria-hidden="true" class="header-anchor">#</a> Sensor</h2> <p>A sensor is an independent software that collects raw data correlated with the
power consumption of monitored software.</p> <p>Data are collected by querying the hardware's machine that hosts the monitored
software. The sensor must be executed on the same machine as the monitored
software. The data are collected throughout the duration of the software. For this reason,
the sensor must operate in parallel.</p> <p>Collected data are stored in an external database to make the data available to
the formula. This database may be hosted on an other machine.</p> <h3 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h3> <p>Because they collect from different hardware, each sensor are very different
from one another. Refer to each sensor documentation to know how to use them.</p> <h2 id="formula"><a href="#formula" aria-hidden="true" class="header-anchor">#</a> Formula</h2> <p>A formula is an independent software that use model to compute the power consumption of
monitored software from the data collected by the sensor.</p> <p>We implement each formula with a common Command Line Interface (CLI) to connect
it to a sensor and to configure its output. In this section, we present how the
connection between the sensor and the formula works. We also present the common
formula's CLI.</p> <h3 id="sensor-connection"><a href="#sensor-connection" aria-hidden="true" class="header-anchor">#</a> Sensor Connection</h3> <p>A formula is connected to a sensor via a database (e.g MongoDB). The sensor writes
the collected data to the database and the formula reads this data from the
database.</p> <p>There are two connection modes:</p> <ul><li><p>&quot;Stream&quot; mode where data is read from the database while the sensor is collecting it</p></li> <li><p>&quot;Post-mortem&quot; mode which analyses the data already collected by the sensor in a
past monitoring phase.</p></li></ul> <p>The default mode of a formula is the &quot;Post-mortem&quot; mode, use the command line
argument <code>-s</code> to enable the &quot;Stream&quot; mode.</p> <h3 id="command-line-interface"><a href="#command-line-interface" aria-hidden="true" class="header-anchor">#</a> Command line interface</h3> <p>The presented CLI is common to all formulas of the PowerAPI toolkit.
Replace <code>FORMULA_NAME</code> with the name of the used formula in the
following commands.</p> <h4 id="install-and-launch-the-formula"><a href="#install-and-launch-the-formula" aria-hidden="true" class="header-anchor">#</a> Install and Launch the formula</h4> <p>All formulas are available on pypi and docker-hub.</p> <p>You can directly launch a docker container containing the formula with the following
command:</p> <pre><code>docker run powerapi/FORMULA_NAME args ...
</code></pre> <p>To use the formula without docker, you can install it with <code>pip</code>:</p> <pre><code>pip3 install FORMULA_NAME
</code></pre> <p>Then run it with python(&gt;=3.7):</p> <pre><code>python3 -m FORMULA_NAME args ...
</code></pre> <h4 id="command-line-arguments"><a href="#command-line-arguments" aria-hidden="true" class="header-anchor">#</a> Command line arguments</h4> <p>You can launch every formula with this common arguments, extra arguments could be
added at the end of the command line (it depends on the formula used):</p> <pre><code>(python3 -m/docker run) FORMULA_NAME input_mongo_uri input_db input_collection output_mongo_uri output_db output_collection
</code></pre> <p>with:</p> <ul><li><code>input_mongo_uri</code> : uri to the mongoDB used by the hwpc-sensor to store its
output data. Use the following format <code>mongodb://MONGO_ADDRESS:MONGO_PORT</code></li> <li><code>input_db</code> : database used by the hwpc-sensor to store its output data</li> <li><code>input_collection</code> : collection used by the hwpc-sensor to store its output data</li> <li><code>output_mongo_uri</code> : uri to the mongoDB used to store the power consumption data. Use the following format <code>mongodb://MONGO_ADDRESS:MONGO_PORT</code></li> <li><code>output_db</code> : database used to store the power consumption data</li> <li><code>output_collection</code> : collection used to store the power consumption data</li></ul> <h4 id="optional-arguments"><a href="#optional-arguments" aria-hidden="true" class="header-anchor">#</a> Optional arguments</h4> <p>List of the optional arguments used to enable some special mode:</p> <ul><li><code>-s</code> : connect to the database with &quot;stream mode&quot;</li> <li><code>-v</code> : verbose mode (for debug)</li></ul> <h4 id="formula-specific-arguments"><a href="#formula-specific-arguments" aria-hidden="true" class="header-anchor">#</a> Formula specific arguments</h4> <p>Some formula may use specific arguments. These arguments are described on their
formula documentation. Just place them after the common CLI arguments</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/powerapi-doc/hwpc.html">
          HWPC Sensor
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/powerapi-doc/assets/js/app.d5220592.js" defer></script><script src="/powerapi-doc/assets/js/2.68cf461d.js" defer></script><script src="/powerapi-doc/assets/js/8.ee533614.js" defer></script>
  </body>
</html>
